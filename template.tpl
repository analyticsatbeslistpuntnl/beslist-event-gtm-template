___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "displayName": "Beslist event",
  "description": "Beslist pixel for sending events and conversions to beslist\u0027s advertiser platform",
  "categories": [
    "AFFILIATE_MARKETING",
    "ADVERTISING",
    "ATTRIBUTION",
    "CONVERSIONS",
    "MARKETING"
  ],
  "id": "cvt_P3FJ3",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/png;base64,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\u003d",
    "displayName": "analyticsatbeslistpuntnl",
    "id": "github.com_analyticsatbeslistpuntnl"
  },
  "containerContexts": [
    "WEB"
  ],
  "securityGroups": []
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "advertiser_id",
    "displayName": "Enter your Beslist advertiser id",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "The advertiser id is given to you by your Beslist account manager."
  },
  {
    "type": "SELECT",
    "name": "event_name",
    "displayName": "Enter event type",
    "macrosInSelect": false,
    "selectItems": [
      {
        "value": "configuration",
        "displayValue": "configuration"
      },
      {
        "value": "conversion",
        "displayValue": "conversion"
      }
    ],
    "simpleValueType": true,
    "defaultValue": "configuration",
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "(configuration|conversion)"
        ]
      },
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "The Beslist event template can only track session_start and conversion events."
  },
  {
    "type": "CHECKBOX",
    "name": "enable_spa_mode",
    "checkboxText": "Enable SPA-mode",
    "simpleValueType": true,
    "help": "Enable when the tag is used on a Single Page Application. This ensures the configuration tag can be fired multiple times without reloading the page."
  },
  {
    "displayName": "Enter contextual event parameters",
    "name": "context_parameters",
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": "Parameter name",
        "name": "custom_name",
        "type": "TEXT"
      },
      {
        "defaultValue": "",
        "displayName": "Parameter value",
        "name": "custom_value",
        "type": "TEXT"
      }
    ],
    "type": "SIMPLE_TABLE",
    "help": "Enter contextual event parameters to enrich data collection and attribution information."
  },
  {
    "displayName": "Optional data",
    "name": "Optional",
    "groupStyle": "ZIPPY_CLOSED",
    "type": "GROUP",
    "subParams": [
      {
        "type": "TEXT",
        "name": "ecommerce",
        "displayName": "Ecommerce object",
        "simpleValueType": true,
        "help": "Enter the \"ecommerce\" object of UA or GA4 here."
      },
      {
        "type": "GROUP",
        "name": "custom_location",
        "displayName": "Custom Location",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "TEXT",
            "name": "custom_host",
            "displayName": "Host",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "custom_path",
            "displayName": "Path",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "custom_query",
            "displayName": "Query",
            "simpleValueType": true
          },
          {
            "type": "TEXT",
            "name": "custom_referrer",
            "displayName": "Referrer",
            "simpleValueType": true
          }
        ],
        "help": "Use to pass a custom location payload. Useful when running inside an iFrame or on some SPAs."
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const injectScript = require('injectScript');
const callInWindow = require('callInWindow');
const setInWindow    = require('setInWindow');
const copyFromWindow = require('copyFromWindow');
const encodeUriComponent = require('encodeUriComponent');
const isConsentGranted = require('isConsentGranted');
const addConsentListener = require('addConsentListener');

// Disable initializing a session when loading the script to DOM.
const initializeSessionOnLoad = false;

const queryParts = [
  "shopid=" + encodeUriComponent(data.advertiser_id),
  "initializeSessionOnLoad=" + (initializeSessionOnLoad ? "true" : "false")
];

const pxl_endpoint = "https://ct.beslist.nl/ct_refresh?" + queryParts.join("&");

var event_context = {};
if(data.context_parameters!==undefined) {
  var context_params = data.context_parameters;
  if(context_params.length > 0){
    context_params.forEach(function(pair) {
      event_context[pair.custom_name] = pair.custom_value;
    });
  }
}

const implementationType = "gtm_gallery_template-1.0.0";
setInWindow("bslst_implementation_type", implementationType, true);

var custom_location = {};
if (
  data.custom_host !== undefined ||
  data.custom_path !== undefined ||
  data.custom_query !== undefined ||
  data.custom_referrer !== undefined
) {
  if (data.custom_host !== undefined) {
    custom_location.host = data.custom_host;
  }
  if (data.custom_path !== undefined) {
    custom_location.path = data.custom_path;
  }
  if (data.custom_query !== undefined) {
    custom_location.query = data.custom_query;
  }
  if (data.custom_referrer !== undefined) {
    custom_location.referrer = data.custom_referrer;
  }

  setInWindow("bslst_custom_location", custom_location, true);
}

function handleBeslistTag() {
  callInWindow("bslst_floodgate_send_events");

  if(data.event_name === "conversion"){
    var sentConversion = callInWindow(
      "bslst_floodgate_has_sent_event",
      data.advertiser_id,
      data.event_name,
      event_context,
      data.ecommerce,
      custom_location
    );

    // If conversion was sent via floodgate, skip; otherwise initialize
    if (!sentConversion) {
      callInWindow(
        "bslst_event",
        data.advertiser_id,
        data.event_name,
        event_context,
        data.ecommerce,
        custom_location
      );
    }
  } else if (data.event_name === "configuration") {
    var sessionStartReasons = callInWindow("bslst_get_session_start_reasons", custom_location) || [];

    var sentSessionStart  = callInWindow(
      "bslst_floodgate_has_sent_event",
      data.advertiser_id,
      "session_start",
      {
        shop_session_start_reasons: sessionStartReasons.join("|")
      },
      {},
      custom_location
    );
    var sentMatchEvent = callInWindow(
      "bslst_floodgate_has_sent_event",
      data.advertiser_id,
      "match_event",
      {},
      {},
      custom_location
    );

    // If both were sent via floodgate, skip; otherwise initialize
    if (!sentSessionStart || !sentMatchEvent) {
      callInWindow("bslst_initialize_session", custom_location);
    }
  }

  // Call data.gtmOnSuccess when the tag is finished.
  data.gtmOnSuccess();
}

function onInjectScriptSuccess(){
  let firedConsentHandler = false;

  if (isConsentGranted('ad_storage')) {
    handleBeslistTag();
    return;
  }

  if (data.event_name === "conversion") {
    callInWindow(
      "bslst_floodgate_event",
      data.advertiser_id,
      data.event_name,
      event_context,
      data.ecommerce,
      custom_location
    );
  } else if (data.event_name === "configuration") {
    callInWindow("bslst_floodgate_initialize_session", custom_location);
  }

  addConsentListener('ad_storage', (consentType, granted) => {
    if (firedConsentHandler || !granted) {
      return;
    }

    firedConsentHandler = true;
    handleBeslistTag();
  });
}

function onInjectScriptFailure(){
  data.gtmOnFailure();
}

//load the pxl functions if needed and cache them
injectScript(pxl_endpoint, onInjectScriptSuccess, onInjectScriptFailure, pxl_endpoint);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_event"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_initialize_session"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_custom_location"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_floodgate_send_events"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_floodgate_has_sent_event"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_floodgate_initialize_session"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_floodgate_event"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_get_session_start_reasons"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "bslst_implementation_type"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://ct.beslist.nl/ct_refresh*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 28-2-2023 08:23:16


